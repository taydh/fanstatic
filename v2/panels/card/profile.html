<script>
	const design = fanstatic.design;

	return async function(roof, data = {}, url) {
		const panelElementId = data.$id || data.id || null;
		const panelScope = data.panelScope || fanstatic.resolvePanelScope(url);
		const model = {
			id: panelElementId,
			photo: data.photo || '',
			name: data.name || true,
			title: data.title || true,
			brief: data.brief || true,
			facebook: data.facebook || '',
			instagram: data.instagram || '',
			twitterX: data.twitterX || '',
			linkedIn: data.linkedIn || '',
			tiktok: data.tiktok || '',
			disabled: data.disabled || false,
		}
		const tagFill = `img src="${model.photo}"`;

		const baseBlockController = await fanstatic.appendPanel(roof, 'block.unit', {
			$id: model.id,
			panelScope: panelScope,
			scope: data.scope,
			innerScope: data.innerScope,
			cap: {[tagFill]: true},
			head: design.wrap([
				design.tag({$tag:data.$nameTag, data: {'pn': 'name'}}, model.name),
				design.tag({$tag:data.$titleTag, data: {'pn': 'title'}}, model.title),
			]),
			body: model.brief,
			foot: design.axis([
				design.div({data: {'pn': 'facebook'}}, model.facebook),
				design.div({data: {'pn': 'instagram'}}, model.instagram),
				design.div({data: {'pn': 'twitterX'}}, model.twitterX),
				design.div({data: {'pn': 'tiktok'}}, model.tiktok),
				design.div({data: {'pn': 'linkedIn'}}, model.linkedIn),
			]),

			$tag: data.$tag || 'article',
			$attr: data.$attr,
			$capTag: data.$photoTag,
			$headTag: data.$headTag,
			$bodyTag: data.$briefTag,
			$footTag: data.$footTag,
		})

		const panelElement = baseBlockController.panelElement;
		const cap = panelElement.querySelector(':scope > [data-pn=cap]')
		const body = panelElement.querySelector(':scope > [data-pn=body]');
		
		if (model.photo) cap.dataset.pn = 'photo';
		if (model.brief) body.dataset.pn = 'brief';
		
		this.controller = {
			panelElement: panelElement,
		};
	}
</script>