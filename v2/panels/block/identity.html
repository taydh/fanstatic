<div></div>

<script>
	const controller = {};
	const design = fanstatic.design;

	return {
		onload: async function(root, data, url) {
			const panelScope = data.panelScope || fanstatic.resolvePanelScope(url);
			const outerScope = data.scope;
			const innerScope = data.innerScope || outerScope || data.id || panelScope;
			const panelElement = root.children[0];
			
			if (data.id) panelElement.id = data.id;
			if (outerScope) panelElement.dataset.pnScope = outerScope;
			panelElement.dataset.pnPanel = panelScope;

			panelElement.innerHTML = fanstatic.renderJhtm([
				design.element(data.$logoTag || 'figure', {style:'display:none', data:{ pn: 'logo'}}),
				design.tag(data.$nameTag || 'div', {style:'display:none', data:{ pn: 'name'}}),
			]);

			controller.panelElement = panelElement;
			controller.logoElement = panelElement.querySelector('[data-pn=logo]');
			controller.nameElement = panelElement.querySelector('[data-pn=name]');
			controller.scope = outerScope;
			controller.panelScope = panelScope;

			let imgProm, nameProm;

			if (data.logo) {
				// controller.logoElement.querySelector('img').setAttribute('src', data.logo)
				imgProm = fanstatic.applyTemplate(controller.logoElement, new fanstatic.panel('base.image', { src: data.logo }));
				controller.logoElement.style.display = 'block';
			}

			if (data.name) {
				nameProm = fanstatic.applyTemplate(controller.nameElement, new fanstatic.panel('base.text', data.name));
				controller.nameElement.style.display = 'block';
			}

			const resolves = await Promise.all([imgProm, nameProm]);

			controller.logoImageController = resolves[0];
		},

		controller: controller
	}
</script>