<script>
	const design = fanstatic.design;
	const controller = {
		panelElement: null,
		itemControllers: [],
	};

	return async function (roof, data = {}, url) {
		const scope = data.scope;
		const stack = data.stack || 'block.base-unit';

		roof.innerHTML = fanstatic.renderJhtm(design.axis(
			data.items.map(item => design.placeholder('panel'))
			, {data: {ds: {scope:scope, role:'items'}}}
		));

		const placeholders = roof.querySelectorAll('[data-ds-placeholder=panel]')

		for (let i=0; i<placeholders.length; i++) {
			controller.itemControllers.push(await fanstatic.replacePanel(placeholders[i], stack, { 
				data: Object.assign(data.items[i], {scope: scope}) 
			}))
		}

		controller.panelElement = roof.children[0];

		this.controller = controller;
	};
</script>
