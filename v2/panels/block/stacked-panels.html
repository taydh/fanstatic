<script>
	const design = fanstatic.design;
	const controller = {};

	return {
		onload: async function (roof, data = {}, url) {
			const scope = data.scope || fanstatic.resolvePanelScope(url);
			const panel = data.panel;

			roof.innerHTML = fanstatic.renderJhtm(design.axis(
				data.items.map(item => design.placeholder('panel'))
				, {data: {ds: {scope:scope, role:'items'}}}
			));

			const placeholders = roof.querySelectorAll('[data-ds-placeholder=panel]')

			for (let i=0; i<placeholders.length; i++) {
				await fanstatic.replacePanel(placeholders[i], panel, { 
					data: Object.assign(data.items[i], {scope: scope}) 
				})
			}

			controller.panelElement = roof.children[0];
		},
		controller: controller
	};
</script>
