<script>
	const design = fanstatic.design;

	return async function (roof, data = {}, url) {
		const panelScope = fanstatic.resolvePanelScope(url);
		const scope = data.scope;
		const panel = data.panel || 'block.basic-block';
		const controller = {
			panelElement: null,
			itemControllers: [],
		};

		roof.innerHTML = fanstatic.renderJhtm(design.axis(
			{data: {pn: {scope:scope, panel:panelScope, role:'items'}}}, 
			data.items.map(item => design.placeholder('panel')),
		));

		const placeholders = roof.querySelectorAll('[data-ds-placeholder=panel]')

		for (let i=0; i<data.items.length; i++) {
			controller.itemControllers.push(await fanstatic.replacePanel(placeholders[i], panel, 
				Object.assign({ scope: scope }, data.items[i])
			));
		}

		controller.panelElement = roof.children[0];

		this.controller = controller;
	};
</script>
