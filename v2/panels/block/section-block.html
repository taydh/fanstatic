<script>
	const design = fanstatic.design;
	const controller = {};

	return async function (roof, data = {}, url) {
		const panelScope = fanstatic.resolvePanelScope(url);
		const scope = data.scope || panelScope;

		if (data.titles && !Array.isArray(data.titles)) data.titles = [data.titles];
		if (data.ends && !Array.isArray(data.ends)) data.ends = [data.ends];

		roof.innerHTML = fanstatic.renderJhtm(
			design.div({data: { pn:  { scope: scope, panel: panelScope }}},
				[
					design.div({'data-pn-role': 'titles'}, data.titles ? data.titles.map(jhtm => design.div({}, jhtm)) : true),
					design.div({'data-pn-role': 'content'}, data.content || true),
					design.div({'data-pn-role': 'ends'}, data.ends ? data.ends.map(jhtm => design.div({}, jhtm)) : true),
				]
			)
		);
		
		const panelElement = roof.children[0];

		controller.panelElement = panelElement;
		controller.titlesElement = panelElement.children[0];
		controller.contentElement = panelElement.children[1];
		controller.endsElement = panelElement.children[2];

		this.controller = controller;
	};
</script>
