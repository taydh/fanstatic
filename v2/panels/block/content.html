<script>
	const design = fanstatic.design;

	return async function (roof, data = {}, url) {
		const panelScope = data.panelScope || fanstatic.resolvePanelScope(url);
		const scope = data.scope || panelScope;

		await fanstatic.appendPanel(roof, 'block.unit', {
			id: data.id,
			panelScope: panelScope,
			scope: scope,
			body: data.content || true,
			foot: data.footnote || true,
		})
		
		const panelElement = roof.children[0];
		
		panelElement.insertAdjacentHTML('afterbegin', fanstatic.renderJhtm(
			design.div({ 'data-pn': 'header'}, [
				design.div({'data-pn':'category'}, data.category || true),
				design.div({'data-pn':'title'}, data.title || true),
				design.div({'data-pn':'subtitle'}, data.subtitle || true),
				design.div({'data-pn':'caption'}, data.caption || true),
			])
		));

		const body = panelElement.querySelector('[data-pn=body]');
		const foot = panelElement.querySelector('[data-pn=foot]');

		if (body) body.dataset.pn = 'content';
		if (foot) foot.dataset.pn = 'footnote';

		this.controller = {
			panelElement: panelElement,
			scope: scope,
			panelScope: panelScope,
		};
	};
</script>
