<nav></nav>

<script>
	const design = fanstatic.design;

	return async function(roof, data, url) {
		const panelElementId = data.$id || data.id || null;
		const panelScope = data.panelScope || fanstatic.resolvePanelScope(url);
		const outerScope = data.scope;
		const innerScope = data.innerScope || outerScope || panelElementId || panelScope;
		const panelElement = roof.children[0];

		if (panelElementId) panelElement.id = panelElementId;
		if (outerScope) panelElement.dataset.pnScope = outerScope;
		panelElement.dataset.pnPanel = panelScope;

		panelElement.innerHTML = fanstatic.renderJhtm(
			design.list({ 'data-pn': 'nav_list' }, { 'data-pn': 'nav_item' },
			{
				items: data.links.filter(link => !!link).map(link => {
					const href = (link.url ? fanstatic.sanitizeAttrValue(link.url) : null) || null;

					return href 
						? design.element('a', { href: href, 'data-pn': 'nav_link' }, link.label || true)
						: design.element('span', { 'data-pn': 'nav_link' }, link.label || true)
				}),
			})
		);

		const listElement = panelElement.children[0];
		listElement.querySelectorAll(':scope > [data-ds]').forEach(elem => elem.removeAttribute('data-ds'));
		listElement.removeAttribute('data-ds');

		// data.links.forEach((link, i) => {
		// 	const a = listElement.querySelector(`:scope > [data-pn=nav_item]:nth-of-type(${i + 1}) > [data-pn=nav_link]`);

		// 	a.disabled = link.disabled || false;
		// 	a.addEventListener('click', function(ev) {
		// 		if (this.disabled) {
		// 			console.log('nav-link element is disabled, click event cancelled!');
		// 			ev.preventDefault();
		// 		}
		// 	});
		// });

		this.controller = {
			panelElement: panelElement,
			scope: outerScope,
			panelScope: panelScope,
		};
	}
</script> 