<script>
	const design = fanstatic.design;
	const controller = {};

	return {
		onload: async function (roof, data = {}, url) {
			const scope = data.scope || fanstatic.resolvePanelScope(url);
			const tmpl1 = await fanstatic.insertPanel(roof, 'section.containerized', { data: { design: { scope: scope }}});
			const panelElement = roof.children[0];

			panelElement.dataset.dsPanel = scope;
			panelElement.querySelector('[data-ds-role=container]').innerHTML = fanstatic.renderJhtm([
				design.wrap(design.placeholder('unit'))
			]);

			const tmpl2 = await fanstatic.replacePanel(panelElement.querySelector('[data-ds-placeholder=unit]'), 'block.base-unit', {
				data: Object.assign(data, { 
					id: data.id || null,
					scope:scope,
				}),
			});

			controller.panelElement = panelElement;
		},
		controller: controller
	};
</script>
