<section></section>

<script>
	const design = fanstatic.design;

	return async function (roof, data = {}, url) {
		const panelScope = data.panelScope || fanstatic.resolvePanelScope(url);
		const outerScope = data.scope;
		const innerScope = data.innerScope || outerScope || data.id || panelScope;
		const panelElement = roof.children[0];

		if (data.id) panelElement.id = data.id;
		if (outerScope) panelElement.dataset.pnScope = outerScope;
		panelElement.dataset.pnPanel = panelScope;

		const contentBlockController = await fanstatic.insertPanel(panelElement, 'block.content', 
			Object.assign(data, {
				id: null,
				panelScope: null,
				scope: outerScope,
				innerScope: innerScope,
			})
		);

		contentBlockController.panelElement.dataset.pn = 'container';

		this.controller = {
			panelElement: panelElement,
			containerElement: contentBlockController.panelElement,
			contentBlockController: contentBlockController,
		}
	}
</script>
