<script>
	const design = fanstatic.design;
	const controller = {};

	return {
		onload: async function (roof, data = {}, url) {
			const panel = data.panel || 'block.basic-block';
			const scope = data.scope || fanstatic.resolvePanelScope(url);
			const sectionController = await fanstatic.insertPanel(roof, 'section.containerized', { 
				id: data.id || null,
				scope: scope,
				starts: data.starts,
				ends: data.ends,
			});

			// tmpl1.containerElement.insertAdjacentHTML('afterbegin', fanstatic.renderJhtm(
			// 		design.axis({data:{thm:{scope:scope, role:'section_title'}}},
			// 			data.titles ? data.titles.map(title => design.div([title])) : true)
			// ));

			const itemController = await fanstatic.insertPanel(sectionController.containerElement, panel,
				Object.assign(data.item || {}, {
					scope:scope,
				})
			);

			const panelElement = sectionController.panelElement;
			
			panelElement.dataset.pnPanel = scope;

			controller.panelElement = panelElement;
			controller.itemElement = itemController.panelElement;
			controller.itemController = itemController;
		},
		controller: controller
	};
</script>