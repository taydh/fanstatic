<script>
	const design = fanstatic.design;
	const controller = {};

	return {
		onload: async function (roof, data, url) {
			const titles = data.titles || null
			const scope = data.scope = data.scope || fanstatic.resolvePanelScope(url);
			const data2 = {
				id: data.id || null,
				scope: scope,
				items: [
					design.wrap([
						(titles) 
							? design.axis(titles.map(title => design.element('div', title)), {data:{ds:{role:'section-title', scope:scope}}})
							: null,
						design.placeholder('units'), 
					])
				]
			};
			const tmpl1 = await fanstatic.insertPanel(roof, 'section.containerized', { data: data2 });
			const panel = roof.children[0];

			const tmpl2 = await fanstatic.replacePanel(panel.querySelector('[data-ds-placeholder=units]'), 'block.stacked-units', {
				data: {
					scope: scope,
					items: data.items,
				},
			});

			controller.panelElement = panel;
		},
		controller: controller
	};
</script>
