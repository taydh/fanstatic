<script>
	const design = fanstatic.design;

	return async function (roof, data, url) {
		const panelScope = data.panelScope || fanstatic.resolvePanelScope(url);
		const outerScope = data.scope;
		const innerScope = data.innerScope || outerScope || data.id || panelScope;

		// const stackPanel = (data.stackPanels 
		// 	? data.stackPanels.panel 
		// 	: { stackPanel: { panel: 'block.actionable-block', items: [] }}
		// ) || 'block.actionable-block';

		const itemControllers = [];
		
		const sectionController = await fanstatic.insertPanel(roof, 'section.containerized-subcontent',
			Object.assign(data, {
				panelScope: panelScope,
				scope: outerScope,
				innerScope: innerScope,
				item: new fanstatic.panel('cluster.stack', {
					scope: outerScope,
					items: data.items,
					$tag: data.$itemsTag,
					$itemTag: data.$itemTag,
				}),
			})
		);

		sectionController.subPanelController.panelElement.dataset.pn = 'items';

		this.controller = sectionController;
	}
</script>
