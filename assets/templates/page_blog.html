<script>
	return async function(roof, data) {
		var settings = await fanstatic.fetchJson('./contents/blog/settings.json')
		var usp = new URLSearchParams(window.location.search)

		if (!usp.has('post')) {
			await fanstatic.append(roof, './contents/blog/' + settings.index, {
				data: {
					settings: settings,
				}
			})
		}
		else {
			let slug = usp.get('post')
			let post = null

			if (post = settings.posts.find(o => o.slug == slug)) {
				await fanstatic.loadTemplates([
					'./assets/component/layout_blog.html',
					'./contents/blog/' + post.slug + '.md'])
				
				await fanstatic.append(roof, './assets/component/layout_blog.html')
				await fanstatic.append(roof.querySelector('div'), './contents/blog/' + post.slug + '.md')
			}
		}
	}
</script>